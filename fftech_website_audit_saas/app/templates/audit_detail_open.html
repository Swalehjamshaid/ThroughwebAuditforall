{% extends 'base_open.html' %}
{% block content %}
<div class='row g-4'>
  <div class='col-md-4'>
    <div class='card h-100'>
      <div class='card-body'>
        <h5 class='card-title'>Summary</h5>
        <p class='metric'>Grade: <b>{{ audit.grade }}</b></p>
        <p class='metric'>Health: <b>{{ audit.health_score }}/100</b></p>
        <a class='btn btn-outline-primary btn-sm' href='/report/pdf/open?url={{ website.url }}'>Download Certified PDF</a>
      </div>
    </div>
  </div>
  <div class='col-md-8'>
    <div class='card h-100'>
      <div class='card-body'>
        <h5 class='card-title'>Category Scores</h5>
        <canvas id='barChart' height='120'></canvas>
      </div>
    </div>
  </div>
</div>
<div class='row g-4 mt-1'>
  <div class='col-md-6'>
    <div class='card h-100'>
      <div class='card-body'>
        <h5 class='card-title'>Radar Comparison</h5>
        <canvas id='radarChart' height='160'></canvas>
      </div>
    </div>
  </div>
  <div class='col-md-6'>
    <div class='card h-100'>
      <div class='card-body'>
        <h5 class='card-title'>Metrics</h5>
        {% if audit.metrics %}
        <ul class='list-group'>
          {% for m in audit.metrics %}
          <li class='list-group-item d-flex justify-content-between'><span>{{ m[0] }}</span><span>{{ m[1] }}</span></li>
          {% endfor %}
        </ul>
        {% else %}
        <p class='text-muted'>No metrics provided.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
{% block scripts %}
<script>
const cats = {{ audit.category_scores | tojson }};
const labels = cats.map(x => x.name);
const values = cats.map(x => x.score);
new Chart(document.getElementById('barChart'), { type:'bar', data:{ labels, datasets:[{ label:'Score %', data:values, backgroundColor:'#3498DB'}] }, options:{ scales:{ y:{ min:0, max:100 } } } });
new Chart(document.getElementById('radarChart'), { type:'radar', data:{ labels, datasets:[{ label:'Score', data:values, borderColor:'#0057D9', backgroundColor:'rgba(0,87,217,.15)' }] }, options:{ scales:{ r:{ min:0, max:100 } } } });
</script>
{% endblock %}
