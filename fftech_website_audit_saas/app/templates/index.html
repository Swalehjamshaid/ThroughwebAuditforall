async function startAudit() {
    const urlInput = document.getElementById('auditUrl');
    const urlValue = urlInput.value.trim();
    
    if(!urlValue) return alert("Enter a URL");

    try {
        const response = await fetch('/audit/run', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json' // Matches Pydantic requirement
            },
            body: JSON.stringify({ url: urlValue }) // Send as JSON object
        });

        if (!response.ok) {
            const error = await response.json();
            console.error("422 Details:", error);
            throw new Error("Validation Error");
        }
        
        const data = await response.json();
        
        // This triggers the visual graph
        updateChart(data.categories);
        document.getElementById('gradeValue').innerText = data.grade;

    } catch (error) {
        console.error("Audit failed:", error);
    }
}
