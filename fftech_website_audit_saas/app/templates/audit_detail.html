
{% extends 'base.html' %}
{% block content %}
<div class="row g-4">
  <div class="col-lg-8">
    <div class="card p-4">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h1 class="h5">Audit: {{ website.url }}</h1>
        <span class="badge bg-primary">Grade {{ audit.grade }}</span>
      </div>
      <p class="text-secondary">Executed at {{ audit.created_at }}</p>
      <div class="progress mb-3"><div class="progress-bar" style="width: {{ audit.health_score }}%"></div></div>
      <h2 class="h6">Executive Summary</h2>
      <p>{{ audit.exec_summary }}</p>
    </div>
  </div>
  <div class="col-lg-4">
    <div class="card p-3">
      <h2 class="h6">Category Scores</h2>
      <ul class="list-group list-group-flush">
        {% for c in audit.category_scores %}
          <li class="list-group-item bg-transparent d-flex justify-content-between align-items-center">{{ c.name }}<span class="badge bg-info">{{ c.score }}%</span></li>
        {% endfor %}
      </ul>
      <a class="btn btn-brand mt-3 w-100" href="/report/pdf/{{ website.id }}">Download Certified PDF</a>
    </div>
  </div>
</div>

<div class="row g-4 mt-1">
  <div class="col-12">
    <div class="card p-3">
      <h2 class="h6">Detailed Metrics</h2>
      <div class="table-responsive">
        <table class="table table-striped">
          <thead><tr><th>#</th><th>Metric</th><th>Status</th><th>Details</th></tr></thead>
          <tbody>
            {% for m in audit.metrics %}
            <tr>
              <td>{{ loop.index }}</td>
              <td>{{ m.name }}</td>
              <td>
                {% if m.status == 'good' %}<span class="metric-good">Good</span>
                {% elif m.status == 'warn' %}<span class="metric-warn">Warning</span>
                {% else %}<span class="metric-bad">Critical</span>
                {% endif %}
              </td>
              <td>{{ m.details }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}
