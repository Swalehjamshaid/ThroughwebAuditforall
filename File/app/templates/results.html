
{% extends 'base.html' %}
{% block title %}Audit Results{% endblock %}
{% block content %}
<h2>Latest Audit Results</h2>
{% if website %}
  <p><strong>Site:</strong> {{ website.url }}</p>
  {% if audit %}
    <p><strong>Grade:</strong> {{ audit.grade }} â€¢ <strong>Metrics:</strong> {{ audit.metrics_count }}</p>
    <div class="card">
      <canvas id="radar" height="160"></canvas>
    </div>
    <div class="card">
      <p class="muted">Sample metrics (first 8):</p>
      <ul>
        {% for k, v in audit.metrics.items()|list[:8] %}
        <li><strong>{{ k }}</strong>: {{ v }}</li>
        {% endfor %}
      </ul>
    </div>
  {% else %}
    <p>No audit found for this website yet.</p>
  {% endif %}
  <form method="post" action="/ui/audits/run" class="card" style="max-width:520px">
    <input type="hidden" name="website_id" value="{{ website.id }}"/>
    <button class="btn primary" type="submit">Run Audit Now</button>
    <a class="btn" href="/audit_history?website_id={{ website.id }}" style="margin-left:8px">View History</a>
    <a class="btn" href="/schedule?website_id={{ website.id }}" style="margin-left:8px">Schedule Report</a>
  </form>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    {% if audit %}
    const radar = document.getElementById('radar');
    const data = {
      labels: ['Performance','Accessibility','SEO','Best Practices','Security'],
      datasets: [{
        label: 'Scores',
        data: [88,95,90,92,89],
        borderColor: '#5cc8ff',
        backgroundColor: 'rgba(92,200,255,.2)'
      }]
    };
    new Chart(radar,{type:'radar',data,options:{scales:{r:{angleLines:{color:'#203042'},grid:{color:'#203042'},pointLabels:{color:'#8aa0b6'}}}}});
    {% endif %}
  </script>
{% else %}
  <p>Website not found.</p>
{% endif %}
{% endblock %}
