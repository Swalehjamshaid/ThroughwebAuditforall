
{% extends 'base.html' %}
{% block content %}
<h2>Your Audits</h2>
<p class="text-muted">Free users can run up to 10 saved audits. Upgrade to enable scheduling and long-term history.</p>
<div id="list"></div>
<script>
(async ()=>{
  const res = await fetch('/api/audit/list');
  const data = await res.json();
  if (res.ok){
    if (!data.length){
      list.innerHTML = '<div class="alert alert-secondary">No audits yet.</div>'
      return;
    }
    list.innerHTML = data.map(a=>`<div class='card mb-2'><div class='card-body d-flex justify-content-between'>
      <div>
        <div><strong>${a.url}</strong></div>
        <div class='small text-muted'>Score ${a.score} • Grade ${a.grade} • Coverage ${a.coverage}%</div>
      </div>
      <div class='d-flex gap-2'>
        <a class='btn btn-sm btn-outline-primary' href='/api/report/pdf/${a.id}'>PDF</a>
        <a class='btn btn-sm btn-outline-secondary' href='/api/report/xlsx/${a.id}'>XLSX</a>
        <a class='btn btn-sm btn-outline-secondary' href='/api/report/pptx/${a.id}'>PPTX</a>
      </div>
    </div></div>`).join('');
  } else {
    list.innerHTML = '<div class="alert alert-danger">Please sign in.</div>'
  }
})();
</script>
{% endblock %}
