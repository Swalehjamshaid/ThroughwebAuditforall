<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>FF TECH | Elite Web Audit</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-950 text-white p-10">

<div class="max-w-6xl mx-auto space-y-8">

    <h1 class="text-5xl font-black text-center">
        FF TECH <span class="text-blue-500">ELITE</span>
    </h1>

    <div class="flex gap-4 justify-center">
        <input id="url" class="p-4 w-96 text-black rounded" placeholder="https://example.com">
        <button onclick="runAudit()" class="bg-blue-600 px-6 py-4 rounded font-bold">
            Run Audit
        </button>
    </div>

    <div id="result" class="hidden space-y-6">

        <div class="text-center">
            <div id="score" class="text-7xl font-black text-blue-400"></div>
            <p class="uppercase tracking-widest text-slate-400">Overall Health</p>
        </div>

        <pre id="summary" class="bg-slate-800 p-6 rounded text-sm"></pre>

        <button onclick="downloadPDF()" class="bg-white text-black px-6 py-4 rounded font-bold">
            Download PDF
        </button>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-4" id="metrics"></div>

    </div>
</div>

<script>
let report = null;

async function runAudit() {
    const url = document.getElementById("url").value;
    const res = await fetch("/audit", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({url})
    });

    report = await res.json();

    document.getElementById("result").classList.remove("hidden");
    document.getElementById("score").innerText = report.total_grade + "/100";
    document.getElementById("summary").innerText = report.summary;

    const grid = document.getElementById("metrics");
    grid.innerHTML = "";
    report.metrics.forEach(m => {
        grid.innerHTML += `
            <div class="bg-slate-800 p-4 rounded">
                <div class="text-xs text-slate-400">${m.category}</div>
                <div class="font-bold text-sm">${m.name}</div>
                <div class="text-2xl font-black text-blue-400">${m.score}</div>
            </div>
        `;
    });
}

async function downloadPDF() {
    const res = await fetch("/download", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(report)
    });
    const blob = await res.blob();
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "FFTech_Audit.pdf";
    a.click();
}
</script>

</body>
</html>
