INDEX_HTML = r"""<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FF Tech â€” Enterprise Web Audit</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;700;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; }
        .glass { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(12px); border: 1px solid rgba(226, 232, 240, 1); }
        .premium-blur { filter: blur(15px); pointer-events: none; opacity: 0.5; }
        .gradient-text { background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    </style>
</head>
<body class="text-slate-900">
    <header class="p-6 flex justify-between items-center max-w-7xl mx-auto">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center text-white text-xl shadow-lg shadow-indigo-200">
                <i class="fas fa-shield-halved"></i>
            </div>
            <h1 class="font-extrabold text-2xl tracking-tighter">FF TECH <span class="font-normal text-slate-400 text-sm">PRO AUDIT</span></h1>
        </div>
        <div class="flex gap-4">
            <button onclick="location.reload()" class="font-bold text-slate-600 hover:text-indigo-600 transition-colors">Home</button>
            <button class="bg-indigo-600 text-white px-6 py-2.5 rounded-xl font-bold shadow-md hover:bg-indigo-700 transition-all">Sign In</button>
        </div>
    </header>

    <section class="max-w-4xl mx-auto px-6 py-20 text-center">
        <h2 class="text-6xl font-extrabold mb-6 tracking-tight">Audit Your <span class="gradient-text">Website.</span></h2>
        <p class="text-slate-500 text-lg mb-12">Professional analysis of 250+ technical metrics with automated reporting.</p>
        
        <form id="audit-form" class="flex flex-col md:flex-row gap-3 p-3 glass rounded-3xl shadow-2xl border-2 border-white">
            <input id="website-url" type="url" placeholder="https://example.com" required 
                   class="flex-1 bg-transparent px-6 py-4 outline-none font-bold text-lg">
            <button type="submit" class="bg-indigo-600 text-white px-10 py-4 rounded-2xl font-black text-lg shadow-xl shadow-indigo-100 hover:scale-105 transition-all">
                ANALYZE
            </button>
        </form>
    </section>

    <section id="results-area" class="hidden max-w-7xl mx-auto px-6 pb-24 space-y-12">
        
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="glass p-10 rounded-[2.5rem] flex flex-col items-center justify-center text-center shadow-sm">
                <div class="relative w-48 h-48 mb-6">
                    <canvas id="score-gauge"></canvas>
                    <div class="absolute inset-0 flex flex-col items-center justify-center">
                        <span id="grade-badge" class="text-6xl font-black text-slate-900">--</span>
                        <span id="score-pct" class="text-slate-400 font-bold">0%</span>
                    </div>
                </div>
                <p class="font-black text-slate-400 uppercase tracking-widest text-xs">Overall Health Index</p>
            </div>

            <div class="lg:col-span-2 glass p-10 rounded-[2.5rem] relative">
                <div class="flex justify-between items-start mb-6">
                    <h3 class="text-3xl font-black">Executive Summary</h3>
                    <button onclick="window.open('/export-pdf?url='+document.getElementById('website-url').value)" 
                            class="bg-slate-100 text-slate-900 px-5 py-2.5 rounded-xl font-bold flex items-center gap-2 hover:bg-slate-200">
                        <i class="fas fa-file-pdf"></i> PDF REPORT
                    </button>
                </div>
                <p id="summary-content" class="text-slate-500 text-lg leading-relaxed mb-10"></p>
                <div class="grid grid-cols-3 gap-6">
                    <div class="text-center bg-rose-50 p-4 rounded-2xl border border-rose-100">
                        <p id="stat-err" class="text-3xl font-black text-rose-500">0</p>
                        <p class="text-[10px] font-bold text-rose-400 uppercase">Errors</p>
                    </div>
                    <div class="text-center bg-amber-50 p-4 rounded-2xl border border-amber-100">
                        <p id="stat-warn" class="text-3xl font-black text-amber-500">0</p>
                        <p class="text-[10px] font-bold text-amber-400 uppercase">Warnings</p>
                    </div>
                    <div class="text-center bg-indigo-50 p-4 rounded-2xl border border-indigo-100">
                        <p id="stat-not" class="text-3xl font-black text-indigo-500">0</p>
                        <p class="text-[10px] font-bold text-indigo-400 uppercase">Notices</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="metrics-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            </div>

        <div id="premium-lock" class="hidden glass rounded-[3rem] p-16 text-center border-2 border-indigo-200 shadow-2xl">
            <i class="fas fa-lock text-4xl text-indigo-600 mb-6"></i>
            <h4 class="text-3xl font-black mb-4">Unlock Full 250-Metric Report</h4>
            <p class="text-slate-500 mb-8 max-w-lg mx-auto">This public audit is limited. Join FF Tech to access deeper technical insights, Core Web Vitals, and historical tracking.</p>
            <button onclick="alert('Checkout Active')" class="bg-indigo-600 text-white px-10 py-4 rounded-2xl font-black shadow-lg">Upgrade to Premium</button>
        </div>
    </section>

    <script>
        const $ = s => document.querySelector(s);
        let scoreChart = null;

        $('#audit-form').onsubmit = async (e) => {
            e.preventDefault();
            const url = $('#website-url').value;
            const res = await fetch(`/audit?url=${encodeURIComponent(url)}`);
            const data = await res.json();
            
            // Show Section
            $('#results-area').classList.remove('hidden');
            
            // Render Text Data
            $('#grade-badge').innerText = data.grade;
            $('#score-pct').innerText = data.overall + '%';
            $('#summary-content').innerText = data.summary;
            $('#stat-err').innerText = data.errors || 0;
            $('#stat-warn').innerText = data.warnings || 0;
            $('#stat-not').innerText = data.notices || 0;

            // Main Score Chart
            if(scoreChart) scoreChart.destroy();
            scoreChart = new Chart($('#score-gauge'), {
                type: 'doughnut',
                data: data.overall_gauge,
                options: { cutout: '85%', plugins: { legend: { display: false } } }
            });

            // Metrics Logic
            const grid = $('#metrics-container');
            grid.innerHTML = '';
            data.metrics.forEach(m => {
                const card = document.createElement('div');
                card.className = 'glass p-6 rounded-2xl shadow-sm';
                card.innerHTML = `<p class="text-[10px] font-black text-slate-400 uppercase mb-4 tracking-widest">Signal #${m.num}</p>
                                  <canvas id="m-chart-${m.num}" height="140"></canvas>`;
                grid.appendChild(card);
                new Chart($(`#m-chart-${m.num}`), {
                    type: m.chart_type,
                    data: m.chart_data,
                    options: { plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false } } }
                });
            });

            // Blur Premium Content
            if(!data.premium) {
                grid.classList.add('premium-blur');
                $('#premium-lock').classList.remove('hidden');
            } else {
                grid.classList.remove('premium-blur');
                $('#premium-lock').classList.add('hidden');
            }

            window.scrollTo({ top: $('#results-area').offsetTop - 100, behavior: 'smooth' });
        };
    </script>
</body>
</html>"""
