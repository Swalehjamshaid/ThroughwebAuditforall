<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>FF TECH ELITE v3 | World's Most Advanced Web Audit</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
body{
  font-family:Inter,sans-serif;
  background:linear-gradient(135deg,#0f172a,#1e293b);
  color:#e5e7eb
}
.card{
  background:rgba(30,41,59,.85);
  backdrop-filter:blur(14px);
  border:1px solid rgba(99,102,241,.25);
  border-radius:1.5rem
}
.glow{box-shadow:0 0 40px rgba(16,185,129,.45)}
.step{opacity:.35;transition:.4s}
.step.active{opacity:1;color:#34d399}
.progress-ring{transition:1.6s ease}
</style>
</head>

<body class="min-h-screen">

<!-- HERO -->
<section class="py-20 text-center bg-gradient-to-r from-emerald-500 via-cyan-500 to-indigo-500 text-black">
  <h1 class="text-7xl font-black mb-6">FF TECH ELITE <span class="text-white">v3</span></h1>
  <p class="text-2xl max-w-4xl mx-auto">
    Enterprise Website Audit Engine<br>
    Lighthouse ‚Ä¢ Real Browser ‚Ä¢ 300+ Metrics
  </p>

  <div class="max-w-4xl mx-auto mt-16 card p-12 glow text-white">
    <div class="grid md:grid-cols-3 gap-6">
      <input id="urlInput" class="col-span-2 px-6 py-5 rounded-xl bg-black/30 border border-white/20"
        placeholder="https://example.com">
      <select id="modeInput" class="px-6 py-5 rounded-xl bg-black/30 border border-white/20">
        <option value="desktop">Desktop</option>
        <option value="mobile">Mobile</option>
      </select>
    </div>
    <button onclick="runAudit()"
      class="mt-8 w-full py-6 bg-white text-black font-black text-2xl rounded-xl hover:scale-105 transition">
      Launch Full Audit
    </button>
  </div>
</section>

<!-- LOADING -->
<section id="loading" class="hidden max-w-4xl mx-auto px-6 py-24">
  <div class="card p-14 text-center glow">
    <i class="fas fa-microchip text-7xl text-emerald-400 animate-pulse mb-8"></i>
    <h2 class="text-4xl font-black mb-6">Elite Audit Running</h2>

    <ul id="progressSteps" class="space-y-4 text-left max-w-xl mx-auto text-lg">
      <li class="step">üîç Initializing audit engine</li>
      <li class="step">‚ö° Running Lighthouse performance</li>
      <li class="step">üìä Measuring Core Web Vitals</li>
      <li class="step">üîê Inspecting security headers</li>
      <li class="step">üß† SEO & DOM intelligence</li>
      <li class="step">üèÅ Final scoring & roadmap</li>
    </ul>
  </div>
</section>

<!-- RESULTS -->
<section id="results" class="hidden max-w-7xl mx-auto px-6 py-24 space-y-24">

<!-- HEADER -->
<div class="text-center">
  <h2 class="text-6xl font-black mb-4">Audit Complete</h2>
  <p id="auditedUrl" class="text-3xl text-emerald-400 font-bold"></p>
  <p id="auditedAt" class="text-slate-400 mt-2"></p>
</div>

<!-- OVERALL SCORE RING -->
<div class="max-w-xl mx-auto card p-16 text-center glow">
  <svg width="200" height="200" class="mx-auto">
    <circle cx="100" cy="100" r="85" stroke="#1f2937" stroke-width="14" fill="none"/>
    <circle id="scoreRing" cx="100" cy="100" r="85"
      stroke="#34d399" stroke-width="14" fill="none"
      stroke-dasharray="534" stroke-dashoffset="534"
      stroke-linecap="round"
      transform="rotate(-90 100 100)"
      class="progress-ring"/>
    <text x="50%" y="52%" text-anchor="middle"
      class="fill-emerald-400 text-5xl font-black" id="overallScore">0%</text>
  </svg>
  <p class="text-2xl font-bold mt-6">Overall Site Health</p>
</div>

<!-- PILLARS -->
<div class="card p-12">
  <h3 class="text-4xl font-bold mb-10 text-center">Pillar Scores</h3>
  <div id="pillarScores" class="grid grid-cols-2 md:grid-cols-4 gap-8"></div>
</div>

<!-- PERFORMANCE -->
<div class="card p-12">
  <h3 class="text-4xl font-bold mb-10 text-center">Core Web Vitals</h3>
  <div id="perfGrid" class="grid grid-cols-2 md:grid-cols-4 gap-6"></div>
</div>

<!-- ROADMAP -->
<div class="card p-12">
  <h3 class="text-4xl font-bold mb-10 text-center">Improvement Roadmap</h3>
  <div id="roadmap" class="prose prose-invert max-w-none"></div>
</div>

<!-- PDF -->
<div class="text-center">
  <button onclick="downloadPDF()"
    class="px-16 py-8 bg-gradient-to-r from-emerald-500 to-cyan-500 text-black text-3xl font-black rounded-2xl hover:scale-110 transition">
    <i class="fas fa-file-pdf mr-4"></i>Download PDF
  </button>
</div>

</section>

<script>
let auditData=null;

async function runAudit(){
  const url=urlInput.value.trim();
  if(!url) return alert("Enter URL");

  results.classList.add("hidden");
  loading.classList.remove("hidden");

  const steps=[...document.querySelectorAll(".step")];
  let i=0;
  const timer=setInterval(()=>{
    if(i<steps.length){steps[i++].classList.add("active")}
  },700);

  try{
    const res=await fetch("/audit",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({url,mode:modeInput.value})
    });
    auditData=await res.json();
    clearInterval(timer);
    renderResults(auditData);
  }catch(e){
    alert("Audit failed");
  }finally{
    loading.classList.add("hidden");
  }
}

function renderResults(d){
  results.classList.remove("hidden");
  auditedUrl.textContent=d.url;
  auditedAt.textContent=d.audited_at;

  const score=d.total_grade||0;
  overallScore.textContent=score+"%";
  scoreRing.style.strokeDashoffset=534-(534*score/100);

  pillarScores.innerHTML="";
  Object.entries(d.pillars||{}).forEach(([k,v])=>{
    pillarScores.innerHTML+=`
    <div class="bg-slate-800/60 rounded-xl p-8 text-center">
      <p class="text-slate-400 mb-2">${k}</p>
      <p class="text-5xl font-black text-emerald-400">${v}%</p>
    </div>`;
  });

  perfGrid.innerHTML="";
  Object.entries(d.perf||{}).forEach(([k,v])=>{
    perfGrid.innerHTML+=`
    <div class="bg-slate-800/60 rounded-xl p-6">
      <p class="text-slate-400 text-sm">${k.replace(/_/g," ")}</p>
      <p class="text-3xl font-bold">${v}</p>
    </div>`;
  });

  roadmap.innerHTML=d.roadmap||"";
}

async function downloadPDF(){
  const r=await fetch("/download",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(auditData)});
  const b=await r.blob();
  const a=document.createElement("a");
  a.href=URL.createObjectURL(b);
  a.download="FF_TECH_ELITE_Report.pdf";
  a.click();
}
</script>
</body>
</html>
