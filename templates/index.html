<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Swealeh.Tech | Website Audit</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
{% if not pdf %}<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>{% endif %}
<style>
body { font-family: 'Segoe UI', sans-serif; background:#f8f9fa; }
.card { border-radius:12px; box-shadow:0 6px 12px rgba(0,0,0,0.1); margin-bottom:20px; padding:15px; }
.card:hover { transform: translateY(-3px); transition:0.3s; }
.metric-title { font-weight:600; }
.metric-value { font-size:1.1em; font-weight:bold; }
.summary { background:#e3f2fd; padding:20px; border-radius:12px; margin-top:20px; }
.weak-area { border:2px solid #dc3545 !important; }
header { text-align:center; margin-bottom:30px; }
header img { width:150px; margin-bottom:10px; }
.progress { height:15px; border-radius:8px; margin-top:5px; }
.progress-bar.Excellent { background-color:#28a745; }
.progress-bar.Good { background-color:#ffc107; }
.progress-bar.Poor { background-color:#dc3545; }
</style>
</head>
<body>
<div class="container my-5">
<header>
<img src="https://via.placeholder.com/150?text=Swealeh.Tech" alt="Swealeh.Tech Logo">
<h1>Swealeh.Tech | Website Audit</h1>
</header>

{% if not pdf %}
<form method="POST">
<div class="input-group mb-3">
<input type="url" class="form-control" name="url" placeholder="Enter website URL" required value="{{ url }}">
<button class="btn btn-primary" type="submit">Run Audit</button>
</div>
</form>
{% endif %}

{% if metrics %}
<div class="row">
{% for metric, data in metrics.items() %}
<div class="col-md-4 col-sm-6">
<div class="card {% if metric in weak_areas %}weak-area{% endif %}">
<div class="metric-title">{{ metric }}</div>
<div class="metric-value">{{ data.value }} ({{ data.grade }})</div>
<div class="progress">
<div class="progress-bar {{ data.grade }}" role="progressbar" style="width: {{ data.score }}%;" aria-valuenow="{{ data.score }}" aria-valuemin="0" aria-valuemax="100"></div>
</div>
</div>
</div>
{% endfor %}
</div>

<div class="summary">
<h4>Weak Areas</h4>
{% if weak_areas %}
<ul>{% for w in weak_areas %}<li>{{ w }}</li>{% endfor %}</ul>
{% else %}<p>None</p>{% endif %}
</div>

<div class="summary">
<h4>Improvement Summary</h4>
<p>{{ summary }}</p>
</div>

{% if category_chart %}
<div class="summary">
<h4>Category Scores</h4>
{% if not pdf %}
<canvas id="categoryChart" width="400" height="150"></canvas>
<script>
const ctx = document.getElementById('categoryChart').getContext('2d');
const categoryChart = new Chart(ctx, {
type:'bar',
data:{
labels: [{% for k,v in category_chart.items() %}'{{k}}',{% endfor %}],
datasets:[{label:'Average Score', data:[{% for k,v in category_chart.items() %}{{v}},{% endfor %}], backgroundColor:['#28a745','#ffc107','#dc3545']}]
},
options:{scales:{y:{beginAtZero:true,max:100}}}
});
</script>
{% else %}
<svg width="400" height="150">
{% set x=0 %}
{% for cat, score in category_chart.items() %}
<rect x="{{x}}" y="{{150 - score*1.5}}" width="50" height="{{score*1.5}}" style="fill:{% if score>=85 %}#28a745{% elif score>=60 %}#ffc107{% else %}#dc3545{% endif %};"></rect>
<text x="{{x+5}}" y="145" fill="#000">{{cat}}</text>
{% set x = x + 60 %}
{% endfor %}
</svg>
{% endif %}
</div>
{% endif %}

{% if not pdf %}
<form method="POST" action="/download_report">
<input type="hidden" name="url" value="{{ url }}">
<div class="text-center my-3">
<button class="btn btn-success btn-lg">Download PDF Report</button>
</div>
</form>
{% endif %}
{% endif %}
</div>
</body>
</html>
