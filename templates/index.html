// Inside your runAudit() function, replace the result handling section:
const result = await response.json();

document.getElementById('grade').innerText = result.data.grade;
document.getElementById('score').innerText = result.data.score;
document.getElementById('downloadBtn').href = `/download/${result.id}`;

// Build the Metrics Table
let metricsHtml = '<table class="w-full text-left border-collapse mt-4 text-sm">';
metricsHtml += '<thead><tr class="border-b"><th>Metric</th><th>Value</th></tr></thead><tbody>';

for (const [key, value] of Object.entries(result.data.metrics)) {
    metricsHtml += `<tr class="border-b">
        <td class="py-1 font-medium text-gray-700">${key.replace(/_/g, ' ').toUpperCase()}</td>
        <td class="py-1 text-gray-600">${value}</td>
    </tr>`;
}
metricsHtml += '</tbody></table>';

document.getElementById('metricsDisplay').innerHTML = metricsHtml; // Ensure you have a div with this ID
resultsDiv.classList.remove('hidden');
