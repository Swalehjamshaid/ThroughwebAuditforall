<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FF TECH | Elite Strategic Intelligence 2025</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
:root {
    --primary: #3b82f6;
    --accent: #22d3ee;
    --dark: #020617;
    --glass: rgba(15,23,42,0.9);
}
body {
    background: radial-gradient(circle at top left, #020617, #0f172a);
    color: #f8fafc;
    font-family: 'Inter', sans-serif;
    min-height: 100vh;
}
.glass {
    background: var(--glass);
    backdrop-filter: blur(24px);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 32px;
}
.metric-card {
    transition: all 0.3s ease;
}
.metric-card:hover {
    transform: translateY(-5px);
    border-color: var(--primary);
}
::-webkit-scrollbar { width: 8px; }
::-webkit-scrollbar-track { background: var(--dark); }
::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }
</style>
</head>
<body class="p-6 md:p-12">
<div class="max-w-7xl mx-auto space-y-12">
    <header class="text-center space-y-6">
        <div class="inline-block px-4 py-1 rounded-full border border-blue-500/30 bg-blue-500/10 text-blue-400 text-xs font-bold tracking-widest uppercase">
            Enterprise Forensic Engine v5.0
        </div>
        <h1 class="text-5xl md:text-7xl font-black tracking-tighter">
            FF TECH <span class="text-blue-500">ELITE</span>
        </h1>
        <p class="text-slate-400 max-w-2xl mx-auto">Global Growth Intelligence & Weighted Efficiency Auditing for 2025 Market Dominance.</p>

        <div class="glass p-3 md:p-4 max-w-3xl mx-auto flex flex-col md:flex-row gap-4 shadow-2xl">
            <input id="urlInput" type="url" placeholder="https://target-website.com"
                class="flex-1 bg-transparent p-4 outline-none text-white placeholder:text-slate-500 border-b md:border-b-0 md:border-r border-white/10">
            <button onclick="runAudit()" id="scanBtn"
                class="bg-blue-600 hover:bg-blue-500 active:scale-95 transition-all px-10 py-4 rounded-2xl font-bold whitespace-nowrap">
                START DEEP SCAN
            </button>
        </div>
    </header>

    <div id="loading" class="hidden py-20 text-center">
        <div class="inline-block w-12 h-12 border-4 border-blue-500/20 border-t-blue-500 rounded-full animate-spin"></div>
        <p class="mt-4 text-blue-400 font-bold tracking-widest animate-pulse">ANALYZING 66+ FORENSIC DATA POINTS...</p>
    </div>

    <div id="results" class="hidden space-y-10 animate-in fade-in duration-700">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            <!-- Key Area Charts -->
            <div class="lg:col-span-4 glass p-10 flex flex-col items-center justify-center space-y-4">
                <div class="grid grid-cols-2 gap-4 w-full">
                    <div v-for="(val,key) in ['Performance','Technical SEO','Security','UX','Content']" class="flex flex-col items-center">
                        <svg width="100" height="100">
                            <circle cx="50" cy="50" r="44" stroke="#ffffff33" stroke-width="12" fill="transparent"/>
                            <circle :id="'circle-'+key" cx="50" cy="50" r="44" stroke="#3b82f6" stroke-width="12" fill="transparent"
                                stroke-dasharray="276.5" stroke-dashoffset="276.5"/>
                            <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" class="text-white font-bold" font-size="12">0%</text>
                        </svg>
                        <p class="text-xs mt-2 text-slate-400 font-bold uppercase">{{key}}</p>
                    </div>
                </div>
                <p class="mt-6 text-xs font-bold tracking-widest text-slate-500 uppercase">Overall Weighted Efficiency Score</p>
            </div>

            <div class="lg:col-span-8 glass p-10 flex flex-col justify-between">
                <div>
                    <h3 class="text-3xl font-black mb-6 italic border-l-4 border-blue-600 pl-6">Executive Strategic Overview</h3>
                    <div id="summary" class="text-slate-300 leading-relaxed text-lg whitespace-pre-wrap"></div>
                </div>
                <div class="mt-8 flex flex-wrap gap-4">
                    <button onclick="downloadPDF()" id="pdfBtn"
                        class="bg-white text-black px-10 py-4 rounded-2xl font-black hover:bg-blue-50 transition-all flex items-center gap-2">
                        EXPORT INVESTOR-READY PDF
                    </button>
                </div>
            </div>
        </div>

        <!-- Metrics Grid -->
        <div>
            <h3 class="text-xl font-bold mb-6 text-slate-400 uppercase tracking-widest">Forensic Matrix Breakdown</h3>
            <div id="metricsGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"></div>
        </div>
    </div>
</div>

<script>
let reportData = null;

async function runAudit(){
    const urlInput = document.getElementById('urlInput');
    const url = urlInput.value.trim();
    if(!url) return alert("Enter a valid URL");

    document.getElementById('scanBtn').disabled = true;
    document.getElementById('loading').classList.remove('hidden');
    document.getElementById('results').classList.add('hidden');

    try{
        const res = await fetch('/audit',{
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({url})
        });
        reportData = await res.json();
        renderResults();
    } catch(e){
        alert("Connection to server failed.");
    } finally{
        document.getElementById('scanBtn').disabled = false;
        document.getElementById('loading').classList.add('hidden');
    }
}

function renderResults(){
    document.getElementById('summary').textContent = reportData.summary;

    // Build Metrics Grid
    const grid = document.getElementById('metricsGrid');
    grid.innerHTML = '';
    reportData.metrics.forEach(m=>{
        const scoreColor = m.score>75?'text-emerald-400':m.score>45?'text-amber-400':'text-rose-500';
        grid.innerHTML+=`
        <div class="glass p-5 metric-card border-white/5 bg-white/5">
            <p class="text-[10px] text-slate-500 font-bold uppercase truncate">${m.cat}</p>
            <h4 class="text-xs font-semibold h-8 mt-1 line-clamp-2">${m.name}</h4>
            <p class="text-[9px] text-slate-400">${m.desc}</p>
            <div class="mt-2 text-xl font-black ${scoreColor}">${m.score}%</div>
        </div>`;
    });

    // Animate Key Area Circles
    const keyAreas = reportData.key_areas;
    let i=0;
    for(const area in keyAreas){
        const circle = document.querySelectorAll('circle')[i*2+1]; // second circle
        const text = document.querySelectorAll('text')[i];
        const val = keyAreas[area];
        const circumference = 2 * Math.PI * 44;
        const offset = circumference - (val/100)*circumference;
        circle.style.strokeDashoffset = offset;
        text.textContent = val + '%';
        i++;
    }

    document.getElementById('results').classList.remove('hidden');
}

async function downloadPDF(){
    if(!reportData) return;
    const btn = document.getElementById('pdfBtn');
    const originalText = btn.innerHTML;
    btn.innerHTML="GENERATING STREAM...";
    try{
        const res = await fetch('/download',{
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify(reportData)
        });
        const blob = await res.blob();
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = `FFTech_Audit_${new Date().getTime()}.pdf`;
        a.click();
    } catch(e){
        alert('PDF generation failed.');
    } finally{
        btn.innerHTML = originalText;
    }
}
</script>
</body>
</html>
