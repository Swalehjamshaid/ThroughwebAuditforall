<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MS TECH | 66-Metric Web Audit</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-950 text-white p-8">

<div class="max-w-7xl mx-auto space-y-8">

<h1 class="text-5xl font-black text-center">MS TECH â€“ Web Audit Engine</h1>

<div class="flex gap-4 justify-center">
<input id="url" placeholder="https://example.com"
 class="px-4 py-3 w-96 rounded text-black">
<button onclick="runAudit()"
 class="bg-blue-600 px-8 py-3 rounded font-bold">Scan</button>
</div>

<div id="score" class="text-center text-6xl font-black mt-6"></div>

<div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4" id="metrics"></div>

<div class="text-center mt-10">
<button onclick="downloadPDF()"
 class="bg-emerald-500 px-10 py-4 rounded font-black">
Download Full PDF
</button>
</div>

</div>

<script>
let report = null;

async function runAudit(){
    const url = document.getElementById("url").value;
    const res = await fetch("/audit", {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({url})
    });
    report = await res.json();

    document.getElementById("score").innerText =
        report.overall + "/100";

    const grid = document.getElementById("metrics");
    grid.innerHTML = "";

    report.metrics.forEach(m => {
        const color = m.score >= 80 ? "text-green-400"
                    : m.score >= 50 ? "text-yellow-400"
                    : "text-red-500";
        grid.innerHTML += `
        <div class="bg-slate-800 p-4 rounded">
            <div class="text-xs text-slate-400">${m.id}</div>
            <div class="font-semibold text-sm h-10">${m.name}</div>
            <div class="text-2xl font-black ${color}">${m.score}</div>
        </div>`;
    });
}

async function downloadPDF(){
    const res = await fetch("/download-pdf",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify(report)
    });
    const blob = await res.blob();
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "MS_Tech_66_Audit.pdf";
    a.click();
}
</script>

</body>
</html>
