<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><title>FF TECH | ELITE COMPARISON</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background: #020617; color: #f8fafc; font-family: 'Inter', sans-serif; }
        .glass { background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; }
    </style>
</head>
<body class="p-8">
    <div class="max-w-7xl mx-auto space-y-10">
        <header class="text-center">
            <h1 class="text-6xl font-black italic tracking-tighter">FF TECH <span class="text-blue-500">ELITE</span></h1>
            <p class="text-slate-500 uppercase tracking-[0.3em] text-xs mt-2">Forensic Comparison Engine v5.0</p>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto">
            <div class="glass p-4"><input id="url1" type="url" placeholder="Main Target Domain" class="w-full bg-transparent p-2 outline-none"></div>
            <div class="glass p-4 border-dashed border-white/20"><input id="url2" type="url" placeholder="Competitor (Optional)" class="w-full bg-transparent p-2 outline-none"></div>
        </div>
        <div class="flex justify-center"><button onclick="runComparison()" id="btn" class="bg-blue-600 px-12 py-4 rounded-2xl font-black uppercase tracking-widest hover:bg-blue-500 transition-all">Start Forensic Sweep</button></div>

        <div id="results" class="hidden grid grid-cols-1 lg:grid-cols-12 gap-6 animate-in fade-in duration-500">
            <div class="lg:col-span-4 glass p-8 flex flex-col items-center justify-center space-y-6">
                <div class="text-center">
                    <div id="score1" class="text-8xl font-black text-blue-500 italic">0</div>
                    <div id="label1" class="text-[10px] font-bold opacity-50 uppercase mt-1 truncate max-w-[150px]">Target</div>
                </div>
                <div id="compScoreDiv" class="text-center hidden border-t border-white/10 pt-6 w-full">
                    <div id="score2" class="text-6xl font-black text-rose-500 italic">0</div>
                    <div id="label2" class="text-[10px] font-bold opacity-50 uppercase mt-1 truncate">Competitor</div>
                </div>
            </div>
            <div class="lg:col-span-8 glass p-6"><canvas id="radarChart"></canvas></div>
            
            <div class="lg:col-span-12 flex justify-center"><button onclick="downloadPDF()" class="bg-white text-black px-10 py-3 rounded-xl font-black uppercase text-xs">Download Forensic PDF</button></div>
        </div>
    </div>

    <script>
        let report1 = null;
        let radarChart = null;

        async function runComparison() {
            const u1 = document.getElementById('url1').value;
            const u2 = document.getElementById('url2').value;
            if(!u1) return;
            document.getElementById('btn').innerText = 'AUDITING...';

            const res1 = await fetch('/audit', { method: 'POST', body: JSON.stringify({url:u1}), headers:{'Content-Type':'application/json'} });
            report1 = await res1.json();
            
            document.getElementById('score1').innerText = report1.total_grade;
            document.getElementById('label1').innerText = u1;

            let datasets = [{
                label: u1,
                data: Object.values(report1.pillars),
                backgroundColor: 'rgba(59, 130, 246, 0.2)', borderColor: '#3b82f6', borderWidth: 2
            }];

            if(u2) {
                const res2 = await fetch('/audit', { method: 'POST', body: JSON.stringify({url:u2}), headers:{'Content-Type':'application/json'} });
                const report2 = await res2.json();
                document.getElementById('score2').innerText = report2.total_grade;
                document.getElementById('label2').innerText = u2;
                document.getElementById('compScoreDiv').classList.remove('hidden');
                datasets.push({
                    label: u2,
                    data: Object.values(report2.pillars),
                    backgroundColor: 'rgba(244, 63, 94, 0.2)', borderColor: '#f43f5e', borderWidth: 2
                });
            }

            updateChart(datasets);
            document.getElementById('results').classList.remove('hidden');
            document.getElementById('btn').innerText = 'Start Forensic Sweep';
        }

        function updateChart(datasets) {
            const ctx = document.getElementById('radarChart');
            if(radarChart) radarChart.destroy();
            radarChart = new Chart(ctx, {
                type: 'radar',
                data: { labels: ['Tech SEO', 'On-Page', 'Performance', 'UX', 'Security'], datasets },
                options: { 
                    scales: { r: { min: 0, max: 100, ticks: { display: false }, grid: { color: 'rgba(255,255,255,0.05)' }, pointLabels: { color: '#fff', font: { size: 12, weight: 'bold' } } } },
                    plugins: { legend: { labels: { color: '#fff' } } }
                }
            });
        }

        async function downloadPDF() {
            const res = await fetch('/download', { method: 'POST', body: JSON.stringify(report1), headers:{'Content-Type':'application/json'} });
            const blob = await res.blob();
            const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'Forensic_Report.pdf'; a.click();
        }
    </script>
</body>
</html>
